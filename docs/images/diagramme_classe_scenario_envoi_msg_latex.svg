<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1210px" preserveAspectRatio="none" style="width:1641px;height:1210px;" version="1.1" viewBox="0 0 1641 1210" width="1641px" zoomAndPan="magnify"><defs><filter height="300%" id="f6j035t86xcij" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[d6cf32f210b51c0ca3b00030020401ab]
class ChatScreen--><rect fill="#FEFECE" filter="url(#f6j035t86xcij)" height="88.652" id="ChatScreen" style="stroke: #A80036; stroke-width: 1.5;" width="236" x="247.18" y="258.5"/><ellipse cx="305.93" cy="279.8441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M308.8988,285.4847 Q308.3206,285.7816 307.68,285.9222 Q307.0394,286.0785 306.3363,286.0785 Q303.8363,286.0785 302.5081,284.4379 Q301.1956,282.7816 301.1956,279.6566 Q301.1956,276.5316 302.5081,274.8754 Q303.8363,273.2191 306.3363,273.2191 Q307.0394,273.2191 307.68,273.3754 Q308.3363,273.5316 308.8988,273.8285 L308.8988,276.5472 Q308.2738,275.9691 307.68,275.7035 Q307.0863,275.4222 306.4613,275.4222 Q305.1175,275.4222 304.43,276.5004 Q303.7425,277.5629 303.7425,279.6566 Q303.7425,281.7504 304.43,282.8285 Q305.1175,283.891 306.4613,283.891 Q307.0863,283.891 307.68,283.6254 Q308.2738,283.3441 308.8988,282.766 L308.8988,285.4847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="114" x="324.43" y="276.3281">«View / Composable»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="65" x="348.93" y="292.6722">ChatScreen</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="248.18" x2="482.18" y1="301.1882" y2="301.1882"/><ellipse cx="258.18" cy="312.1882" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="145" x="267.18" y="316.9471">viewModel: ChatViewModel</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="248.18" x2="482.18" y1="324.1701" y2="324.1701"/><ellipse cx="258.18" cy="335.1701" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="210" x="267.18" y="339.929">ChatScreen(viewModel: ChatViewModel)</text><!--MD5=[100069edc0eb6e31eded194d89e1e47d]
class ChatViewModel--><rect fill="#FEFECE" filter="url(#f6j035t86xcij)" height="163.5614" id="ChatViewModel" style="stroke: #A80036; stroke-width: 1.5;" width="522" x="740.18" y="8"/><ellipse cx="953.43" cy="29.3441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M956.3988,34.9847 Q955.8206,35.2816 955.18,35.4222 Q954.5394,35.5785 953.8363,35.5785 Q951.3363,35.5785 950.0081,33.9379 Q948.6956,32.2816 948.6956,29.1566 Q948.6956,26.0316 950.0081,24.3754 Q951.3363,22.7191 953.8363,22.7191 Q954.5394,22.7191 955.18,22.8754 Q955.8363,23.0316 956.3988,23.3285 L956.3988,26.0472 Q955.7738,25.4691 955.18,25.2035 Q954.5863,24.9222 953.9613,24.9222 Q952.6175,24.9222 951.93,26.0004 Q951.2425,27.0629 951.2425,29.1566 Q951.2425,31.2504 951.93,32.3285 Q952.6175,33.391 953.9613,33.391 Q954.5863,33.391 955.18,33.1254 Q955.7738,32.8441 956.3988,32.266 L956.3988,34.9847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="70" x="982.43" y="25.8281">«ViewModel»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="87" x="973.93" y="42.1722">ChatViewModel</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="741.18" x2="1261.18" y1="50.6882" y2="50.6882"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="748.18" y="58.6882"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="233" x="760.18" y="66.4471">sendMessageUseCase: SendMessageUseCase</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="748.18" y="73.6701"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="169" x="760.18" y="81.429">authRepository: AuthRepository</text><ellipse cx="751.18" cy="91.652" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="166" x="760.18" y="96.4109">uiState: StateFlow&lt;ChatUiState&gt;</text><ellipse cx="751.18" cy="106.6339" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="194" x="760.18" y="111.3928">messages: StateFlow&lt;List&lt;Message&gt;&gt;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="741.18" x2="1261.18" y1="118.6158" y2="118.6158"/><ellipse cx="751.18" cy="129.6158" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="496" x="760.18" y="134.3747">ChatViewModel(sendMessageUseCase: SendMessageUseCase, authRepository: AuthRepository)</text><ellipse cx="751.18" cy="144.5977" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="161" x="760.18" y="149.3566">loadMessages(groupId: String)</text><ellipse cx="751.18" cy="159.5796" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="222" x="760.18" y="164.3385">sendMessage(groupId: String, text: String)</text><!--MD5=[d53bb31c23df53386f7f1a1e066f9281]
class SendMessageUseCase--><rect fill="#FEFECE" filter="url(#f6j035t86xcij)" height="103.6339" id="SendMessageUseCase" style="stroke: #A80036; stroke-width: 1.5;" width="360" x="518.18" y="251"/><ellipse cx="629.43" cy="272.3441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M632.3988,277.9847 Q631.8206,278.2816 631.18,278.4222 Q630.5394,278.5785 629.8363,278.5785 Q627.3363,278.5785 626.0081,276.9379 Q624.6956,275.2816 624.6956,272.1566 Q624.6956,269.0316 626.0081,267.3754 Q627.3363,265.7191 629.8363,265.7191 Q630.5394,265.7191 631.18,265.8754 Q631.8363,266.0316 632.3988,266.3285 L632.3988,269.0472 Q631.7738,268.4691 631.18,268.2035 Q630.5863,267.9222 629.9613,267.9222 Q628.6175,267.9222 627.93,269.0004 Q627.2425,270.0629 627.2425,272.1566 Q627.2425,274.2504 627.93,275.3285 Q628.6175,276.391 629.9613,276.391 Q630.5863,276.391 631.18,276.1254 Q631.7738,275.8441 632.3988,275.266 L632.3988,277.9847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="112" x="658.43" y="268.8281">«Use Case / Domain»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="129" x="649.93" y="285.1722">SendMessageUseCase</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="519.18" x2="877.18" y1="293.6882" y2="293.6882"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="526.18" y="301.6882"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="210" x="538.18" y="309.4471">messageRepository: MessageRepository</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="519.18" x2="877.18" y1="316.6701" y2="316.6701"/><ellipse cx="529.18" cy="327.6701" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="330" x="538.18" y="332.429">SendMessageUseCase(messageRepository: MessageRepository)</text><ellipse cx="529.18" cy="342.652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="334" x="538.18" y="347.4109">invoke(groupId: String, message: Message): Flow&lt;Result&lt;Unit&gt;&gt;</text><!--MD5=[5200d29abc0a9eab969cc3dfab9cb2d1]
class MessageRepository--><rect fill="#FEFECE" filter="url(#f6j035t86xcij)" height="103.6339" id="MessageRepository" style="stroke: #A80036; stroke-width: 1.5;" width="395" x="400.68" y="434"/><ellipse cx="539.43" cy="455.3441" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M535.3519,451.1097 L535.3519,448.9535 L542.7425,448.9535 L542.7425,451.1097 L540.2738,451.1097 L540.2738,459.1879 L542.7425,459.1879 L542.7425,461.3441 L535.3519,461.3441 L535.3519,459.1879 L537.8206,459.1879 L537.8206,451.1097 L535.3519,451.1097 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="113" x="557.93" y="451.8281">«Interface / Domain»</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="103" x="562.93" y="468.1722">MessageRepository</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="401.68" x2="794.68" y1="476.6882" y2="476.6882"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="401.68" x2="794.68" y1="484.6882" y2="484.6882"/><ellipse cx="411.68" cy="495.6882" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="369" x="420.68" y="500.4471">sendMessage(groupId: String, message: Message): Flow&lt;Result&lt;Unit&gt;&gt;</text><ellipse cx="411.68" cy="510.6701" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="325" x="420.68" y="515.429">getMessagesForGroup(groupId: String): Flow&lt;List&lt;Message&gt;&gt;</text><ellipse cx="411.68" cy="525.652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="203" x="420.68" y="530.4109">uploadMedia(...): Flow&lt;Result&lt;String&gt;&gt;</text><!--MD5=[b6bd534d62c6db7f753ffc74f3510d12]
class MessageRepositoryImpl--><rect fill="#FEFECE" filter="url(#f6j035t86xcij)" height="133.5977" id="MessageRepositoryImpl" style="stroke: #A80036; stroke-width: 1.5;" width="506" x="131.18" y="617"/><ellipse cx="312.43" cy="638.3441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M315.3988,643.9847 Q314.8206,644.2816 314.18,644.4222 Q313.5394,644.5785 312.8363,644.5785 Q310.3363,644.5785 309.0081,642.9379 Q307.6956,641.2816 307.6956,638.1566 Q307.6956,635.0316 309.0081,633.3754 Q310.3363,631.7191 312.8363,631.7191 Q313.5394,631.7191 314.18,631.8754 Q314.8363,632.0316 315.3988,632.3285 L315.3988,635.0472 Q314.7738,634.4691 314.18,634.2035 Q313.5863,633.9222 312.9613,633.9222 Q311.6175,633.9222 310.93,635.0004 Q310.2425,636.0629 310.2425,638.1566 Q310.2425,640.2504 310.93,641.3285 Q311.6175,642.391 312.9613,642.391 Q313.5863,642.391 314.18,642.1254 Q314.7738,641.8441 315.3988,641.266 L315.3988,643.9847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="73" x="363.93" y="634.8281">«Data / Impl»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="135" x="332.93" y="651.1722">MessageRepositoryImpl</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="132.18" x2="636.18" y1="659.6882" y2="659.6882"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="139.18" y="667.6882"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="168" x="151.18" y="675.4471">firestoreHelper: FirestoreHelper</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="139.18" y="682.6701"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="174" x="151.18" y="690.429">firebaseStorage: FirebaseStorage</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="132.18" x2="636.18" y1="697.652" y2="697.652"/><ellipse cx="142.18" cy="708.652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="480" x="151.18" y="713.4109">MessageRepositoryImpl(firestoreHelper: FirestoreHelper, firebaseStorage: FirebaseStorage)</text><ellipse cx="142.18" cy="723.6339" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="369" x="151.18" y="728.3928">sendMessage(groupId: String, message: Message): Flow&lt;Result&lt;Unit&gt;&gt;</text><ellipse cx="142.18" cy="738.6158" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="325" x="151.18" y="743.3747">getMessagesForGroup(groupId: String): Flow&lt;List&lt;Message&gt;&gt;</text><!--MD5=[bea5b0d46523efab5ea1c1d339f396f0]
class Message--><rect fill="#FEFECE" filter="url(#f6j035t86xcij)" height="163.5614" id="Message" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="696.18" y="1036"/><ellipse cx="732.33" cy="1057.3441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M735.2987,1062.9847 Q734.7206,1063.2816 734.08,1063.4222 Q733.4394,1063.5785 732.7362,1063.5785 Q730.2362,1063.5785 728.9081,1061.9379 Q727.5956,1060.2816 727.5956,1057.1566 Q727.5956,1054.0316 728.9081,1052.3754 Q730.2362,1050.7191 732.7362,1050.7191 Q733.4394,1050.7191 734.08,1050.8754 Q734.7362,1051.0316 735.2987,1051.3285 L735.2987,1054.0472 Q734.6737,1053.4691 734.08,1053.2035 Q733.4862,1052.9222 732.8612,1052.9222 Q731.5175,1052.9222 730.83,1054.0004 Q730.1425,1055.0629 730.1425,1057.1566 Q730.1425,1059.2504 730.83,1060.3285 Q731.5175,1061.391 732.8612,1061.391 Q733.4862,1061.391 734.08,1061.1254 Q734.6737,1060.8441 735.2987,1060.266 L735.2987,1062.9847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="45" x="754.03" y="1053.8281">«Model»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="51" x="751.03" y="1070.1722">Message</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="697.18" x2="825.18" y1="1078.6882" y2="1078.6882"/><ellipse cx="707.18" cy="1089.6882" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#444444" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="48" x="716.18" y="1094.4471">id: String</text><ellipse cx="707.18" cy="1104.6701" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#444444" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="82" x="716.18" y="1109.429">groupId: String</text><ellipse cx="707.18" cy="1119.652" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#444444" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="85" x="716.18" y="1124.4109">senderId: String</text><ellipse cx="707.18" cy="1134.6339" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#444444" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="104" x="716.18" y="1139.3928">senderName: String</text><ellipse cx="707.18" cy="1149.6158" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#444444" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="63" x="716.18" y="1154.3747">text: String?</text><ellipse cx="707.18" cy="1164.5977" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#444444" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="91" x="716.18" y="1169.3566">mediaUrl: String?</text><ellipse cx="707.18" cy="1179.5796" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#444444" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="90" x="716.18" y="1184.3385">timestamp: Date?</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="697.18" x2="825.18" y1="1191.5614" y2="1191.5614"/><!--MD5=[0af4742892aad57e7106ef64a658d074]
class ChatUiState--><rect fill="#FEFECE" filter="url(#f6j035t86xcij)" height="103.6339" id="ChatUiState" style="stroke: #A80036; stroke-width: 1.5;" width="176" x="984.18" y="251"/><ellipse cx="1034.43" cy="272.3441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1037.3987,277.9847 Q1036.8206,278.2816 1036.18,278.4222 Q1035.5394,278.5785 1034.8362,278.5785 Q1032.3362,278.5785 1031.0081,276.9379 Q1029.6956,275.2816 1029.6956,272.1566 Q1029.6956,269.0316 1031.0081,267.3754 Q1032.3362,265.7191 1034.8362,265.7191 Q1035.5394,265.7191 1036.18,265.8754 Q1036.8362,266.0316 1037.3987,266.3285 L1037.3987,269.0472 Q1036.7737,268.4691 1036.18,268.2035 Q1035.5862,267.9222 1034.9612,267.9222 Q1033.6175,267.9222 1032.93,269.0004 Q1032.2425,270.0629 1032.2425,272.1566 Q1032.2425,274.2504 1032.93,275.3285 Q1033.6175,276.391 1034.9612,276.391 Q1035.5862,276.391 1036.18,276.1254 Q1036.7737,275.8441 1037.3987,275.266 L1037.3987,277.9847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="54" x="1061.43" y="268.8281">«UI State»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="67" x="1054.93" y="285.1722">ChatUiState</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="985.18" x2="1159.18" y1="293.6882" y2="293.6882"/><ellipse cx="995.18" cy="304.6882" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="150" x="1004.18" y="309.4471">isLoadingMessages: Boolean</text><ellipse cx="995.18" cy="319.6701" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="1004.18" y="324.429">sendMessageError: String?</text><ellipse cx="995.18" cy="334.652" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="136" x="1004.18" y="339.4109">currentUserName: String?</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="985.18" x2="1159.18" y1="346.6339" y2="346.6339"/><!--MD5=[2741598bdf59a7d7e0d5c97658fd3022]
class Result--><rect fill="#FEFECE" filter="url(#f6j035t86xcij)" height="103.6339" id="Result" style="stroke: #A80036; stroke-width: 1.5;" width="173" x="1297.68" y="38"/><ellipse cx="1343.43" cy="59.3441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1346.3988,64.9847 Q1345.8206,65.2816 1345.18,65.4222 Q1344.5394,65.5785 1343.8363,65.5785 Q1341.3363,65.5785 1340.0081,63.9379 Q1338.6956,62.2816 1338.6956,59.1566 Q1338.6956,56.0316 1340.0081,54.3754 Q1341.3363,52.7191 1343.8363,52.7191 Q1344.5394,52.7191 1345.18,52.8754 Q1345.8363,53.0316 1346.3988,53.3285 L1346.3988,56.0472 Q1345.7738,55.4691 1345.18,55.2035 Q1344.5863,54.9222 1343.9613,54.9222 Q1342.6175,54.9222 1341.93,56.0004 Q1341.2425,57.0629 1341.2425,59.1566 Q1341.2425,61.2504 1341.93,62.3285 Q1342.6175,63.391 1343.9613,63.391 Q1344.5863,63.391 1345.18,63.1254 Q1345.7738,62.8441 1346.3988,62.266 L1346.3988,64.9847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="77" x="1361.93" y="55.8281">«Sealed Class»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="34" x="1383.43" y="72.1722">Result</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1298.68" x2="1469.68" y1="80.6882" y2="80.6882"/><ellipse cx="1308.68" cy="91.6882" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="43" x="1317.68" y="96.4471">Loading</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1298.68" x2="1469.68" y1="103.6701" y2="103.6701"/><ellipse cx="1308.68" cy="114.6701" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="1317.68" y="119.429">Success&lt;T&gt;(data: T)</text><ellipse cx="1308.68" cy="129.652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="147" x="1317.68" y="134.4109">Error(exception: Throwable)</text><!--MD5=[91a178b110eede54421af66b66a58092]
class FirestoreHelper--><rect fill="#FEFECE" filter="url(#f6j035t86xcij)" height="126.6158" id="FirestoreHelper" style="stroke: #A80036; stroke-width: 1.5;" width="471" x="77.68" y="830"/><ellipse cx="264.93" cy="851.3441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M267.8988,856.9847 Q267.3206,857.2816 266.68,857.4222 Q266.0394,857.5785 265.3363,857.5785 Q262.8363,857.5785 261.5081,855.9379 Q260.1956,854.2816 260.1956,851.1566 Q260.1956,848.0316 261.5081,846.3754 Q262.8363,844.7191 265.3363,844.7191 Q266.0394,844.7191 266.68,844.8754 Q267.3363,845.0316 267.8988,845.3285 L267.8988,848.0472 Q267.2738,847.4691 266.68,847.2035 Q266.0863,846.9222 265.4613,846.9222 Q264.1175,846.9222 263.43,848.0004 Q262.7425,849.0629 262.7425,851.1566 Q262.7425,853.2504 263.43,854.3285 Q264.1175,855.391 265.4613,855.391 Q266.0863,855.391 266.68,855.1254 Q267.2738,854.8441 267.8988,854.266 L267.8988,856.9847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="47" x="305.93" y="847.8281">«Helper»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="88" x="285.43" y="864.1722">FirestoreHelper</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="78.68" x2="547.68" y1="872.6882" y2="872.6882"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="85.68" y="880.6882"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="142" x="97.68" y="888.4471">firestore: FirebaseFirestore</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="78.68" x2="547.68" y1="895.6701" y2="895.6701"/><ellipse cx="88.68" cy="906.6701" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="445" x="97.68" y="911.429">addDocument(collectionPath: String, data: Any, documentId: String?): suspend String</text><ellipse cx="88.68" cy="921.652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="310" x="97.68" y="926.4109">getCollection(collectionPath: String, T: Class): Flow&lt;List&lt;T&gt;&gt;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="78.68" x2="547.68" y1="933.6339" y2="933.6339"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="83.68" y="949.3928">// ...</text><!--MD5=[efae4119fb8b392e85a05fb226890ad7]
class AuthRepository--><rect fill="#FEFECE" filter="url(#f6j035t86xcij)" height="88.652" id="AuthRepository" style="stroke: #A80036; stroke-width: 1.5;" width="230" x="1195.18" y="258.5"/><ellipse cx="1251.43" cy="279.8441" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1247.3519,275.6097 L1247.3519,273.4535 L1254.7425,273.4535 L1254.7425,275.6097 L1252.2738,275.6097 L1252.2738,283.6879 L1254.7425,283.6879 L1254.7425,285.8441 L1247.3519,285.8441 L1247.3519,283.6879 L1249.8206,283.6879 L1249.8206,275.6097 L1247.3519,275.6097 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="113" x="1269.93" y="276.3281">«Interface / Domain»</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="82" x="1285.43" y="292.6722">AuthRepository</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1196.18" x2="1424.18" y1="301.1882" y2="301.1882"/><ellipse cx="1206.18" cy="312.1882" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="204" x="1215.18" y="316.9471">getCurrentUser(): Flow&lt;Result&lt;User?&gt;&gt;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1196.18" x2="1424.18" y1="324.1701" y2="324.1701"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="1201.18" y="339.929">// ...</text><!--MD5=[23901e59d1ccf0ed8cbcf5d6e2a43506]
class FirebaseAuth--><rect fill="#FEFECE" filter="url(#f6j035t86xcij)" height="73.6701" id="FirebaseAuth" style="stroke: #A80036; stroke-width: 1.5;" width="124" x="1506.18" y="53"/><ellipse cx="1521.18" cy="74.3441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1524.1488,79.9847 Q1523.5706,80.2816 1522.93,80.4222 Q1522.2894,80.5785 1521.5863,80.5785 Q1519.0863,80.5785 1517.7581,78.9379 Q1516.4456,77.2816 1516.4456,74.1566 Q1516.4456,71.0316 1517.7581,69.3754 Q1519.0863,67.7191 1521.5863,67.7191 Q1522.2894,67.7191 1522.93,67.8754 Q1523.5863,68.0316 1524.1488,68.3285 L1524.1488,71.0472 Q1523.5238,70.4691 1522.93,70.2035 Q1522.3363,69.9222 1521.7113,69.9222 Q1520.3675,69.9222 1519.68,71.0004 Q1518.9925,72.0629 1518.9925,74.1566 Q1518.9925,76.2504 1519.68,77.3285 Q1520.3675,78.391 1521.7113,78.391 Q1522.3363,78.391 1522.93,78.1254 Q1523.5238,77.8441 1524.1488,77.266 L1524.1488,79.9847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="96" x="1533.18" y="70.8281">«External Service»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="74" x="1544.18" y="87.1722">FirebaseAuth</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1507.18" x2="1629.18" y1="95.6882" y2="95.6882"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1507.18" x2="1629.18" y1="103.6882" y2="103.6882"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="1512.18" y="119.4471">// ...</text><!--MD5=[e3842970833b845cc420be3d503da0c8]
class FirebaseStorage--><rect fill="#FEFECE" filter="url(#f6j035t86xcij)" height="73.6701" id="FirebaseStorage" style="stroke: #A80036; stroke-width: 1.5;" width="124" x="584.18" y="856.5"/><ellipse cx="599.18" cy="877.8441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M602.1488,883.4847 Q601.5706,883.7816 600.93,883.9222 Q600.2894,884.0785 599.5863,884.0785 Q597.0863,884.0785 595.7581,882.4379 Q594.4456,880.7816 594.4456,877.6566 Q594.4456,874.5316 595.7581,872.8754 Q597.0863,871.2191 599.5863,871.2191 Q600.2894,871.2191 600.93,871.3754 Q601.5863,871.5316 602.1488,871.8285 L602.1488,874.5472 Q601.5238,873.9691 600.93,873.7035 Q600.3363,873.4222 599.7113,873.4222 Q598.3675,873.4222 597.68,874.5004 Q596.9925,875.5629 596.9925,877.6566 Q596.9925,879.7504 597.68,880.8285 Q598.3675,881.891 599.7113,881.891 Q600.3363,881.891 600.93,881.6254 Q601.5238,881.3441 602.1488,880.766 L602.1488,883.4847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="96" x="611.18" y="874.3281">«External Service»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="92" x="613.18" y="890.6722">FirebaseStorage</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="585.18" x2="707.18" y1="899.1882" y2="899.1882"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="585.18" x2="707.18" y1="907.1882" y2="907.1882"/><text fill="#777777" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="590.18" y="922.9471">// ...</text><!--MD5=[3fd616f346a44cd59a91eb10b19e157c]
class User--><rect fill="#FEFECE" filter="url(#f6j035t86xcij)" height="48" id="User" style="stroke: #A80036; stroke-width: 1.5;" width="59" x="1402.68" y="462"/><ellipse cx="1417.68" cy="478" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1420.6488,483.6406 Q1420.0706,483.9375 1419.43,484.0781 Q1418.7894,484.2344 1418.0863,484.2344 Q1415.5863,484.2344 1414.2581,482.5938 Q1412.9456,480.9375 1412.9456,477.8125 Q1412.9456,474.6875 1414.2581,473.0313 Q1415.5863,471.375 1418.0863,471.375 Q1418.7894,471.375 1419.43,471.5313 Q1420.0863,471.6875 1420.6488,471.9844 L1420.6488,474.7031 Q1420.0238,474.125 1419.43,473.8594 Q1418.8363,473.5781 1418.2113,473.5781 Q1416.8675,473.5781 1416.18,474.6563 Q1415.4925,475.7188 1415.4925,477.8125 Q1415.4925,479.9063 1416.18,480.9844 Q1416.8675,482.0469 1418.2113,482.0469 Q1418.8363,482.0469 1419.43,481.7813 Q1420.0238,481.5 1420.6488,480.9219 L1420.6488,483.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="27" x="1431.68" y="482.656">User</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1403.68" x2="1460.68" y1="494" y2="494"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1403.68" x2="1460.68" y1="502" y2="502"/><!--MD5=[06bccf735274d65f4f9c484844807709]
reverse link ChatViewModel to ChatScreen--><path d="M720.78,178.06 C648.96,201.09 572.01,226.4 501.18,251 C494.27,253.4 487.18,255.91 480.04,258.47 " fill="none" id="ChatViewModel&lt;-ChatScreen" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="718.72,171.37,739.9,171.94,722.98,184.7,718.72,171.37" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="638.18" y="216.897">observe() / calls()</text><!--MD5=[2c2467e4765a30cf51a7abba2509bc25]
reverse link ChatViewModel to SendMessageUseCase--><path d="M831.14,179.13 C819.75,186.51 808.65,194.15 798.18,202 C779.02,216.35 759.95,234.28 743.68,250.97 " fill="none" id="ChatViewModel&lt;-SendMessageUseCase" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="842.15,172.15,834.9406,171.9917,832.0217,178.5857,839.2311,178.7439,842.15,172.15" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="799.18" y="216.897">composes (via DI)</text><!--MD5=[02b6b6cff8569496cf14cc7e1a65b3c9]
reverse link ChatViewModel to AuthRepository--><path d="M1131.07,179.7 C1170.82,206.84 1212.79,235.5 1246.11,258.25 " fill="none" id="ChatViewModel&lt;-AuthRepository" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="1120.2,172.28,1122.8982,178.9673,1130.1089,179.0486,1127.4106,172.3614,1120.2,172.28" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="1184.18" y="216.897">composes (via DI)</text><!--MD5=[6b9fd2a6dc9181b0bc7ae1b60a388e94]
reverse link SendMessageUseCase to MessageRepository--><path d="M663.42,366.91 C651.35,388.77 637.95,413 626.46,433.8 " fill="none" id="SendMessageUseCase&lt;-MessageRepository" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="669.79,355.38,663.3866,358.6961,663.9847,365.8823,670.3881,362.5663,669.79,355.38" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="651.18" y="399.897">composes (via DI)</text><!--MD5=[a1d4c3c9737fe1070aeb0f084ed53756]
reverse link MessageRepository to MessageRepositoryImpl--><path d="M527.28,551.93 C504.49,572.81 479.22,595.95 456.34,616.91 " fill="none" id="MessageRepository&lt;-MessageRepositoryImpl" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="522.75,546.59,542.23,538.24,532.21,556.91,522.75,546.59" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="504.18" y="582.897">implements</text><!--MD5=[989a4e6e3970e5816e55241f70e956de]
reverse link MessageRepositoryImpl to FirestoreHelper--><path d="M357.3,763.54 C349.82,785.42 341.79,808.89 334.66,829.73 " fill="none" id="MessageRepositoryImpl&lt;-FirestoreHelper" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="361.52,751.22,355.7912,755.5996,357.6305,762.5722,363.3593,758.1926,361.52,751.22" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="352.18" y="795.897">composes (via DI)</text><!--MD5=[2b146340ac13a9b69aa8acfe939daf14]
reverse link MessageRepositoryImpl to FirebaseStorage--><path d="M477.99,759.3 C519.7,792.33 566.89,829.71 600.65,856.44 " fill="none" id="MessageRepositoryImpl&lt;-FirebaseStorage" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="467.8,751.22,470.0183,758.0814,477.2051,758.6728,474.9868,751.8114,467.8,751.22" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="523.18" y="795.897">composes (via DI)</text><!--MD5=[b24215238954099fceeda9bed72e4329]
link ChatViewModel to Message--><path d="M960.86,172.12 C945.3,210.53 931.18,257.62 931.18,302 C931.18,302 931.18,302 931.18,894.5 C931.18,964.48 877.42,1026.11 830.37,1066.66 " fill="none" id="ChatViewModel-&gt;Message" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="826.42,1070.03,835.8626,1067.2304,830.2233,1066.7843,830.6694,1061.1451,826.42,1070.03" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="932.18" y="582.897">uses</text><!--MD5=[bc11998f53359f57f3c155179e4a00d1]
link ChatViewModel to ChatUiState--><path d="M1028.53,172.28 C1036.84,196.99 1045.79,223.57 1053.4,246.2 " fill="none" id="ChatViewModel-&gt;ChatUiState" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1055.01,250.97,1055.9233,241.1636,1053.4117,246.2323,1048.343,243.7208,1055.01,250.97" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="1043.18" y="216.897">manages</text><!--MD5=[abff7d6f5f2efb569d17f7007fd49f94]
link ChatViewModel to User--><path d="M1262.41,172.03 C1350.81,202.03 1430.6,233.07 1443.18,251 C1486.9,313.32 1460.8,409.61 1443.61,456.87 " fill="none" id="ChatViewModel-&gt;User" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1441.77,461.84,1448.6566,454.7991,1443.5131,457.1537,1441.1585,452.0101,1441.77,461.84" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="1467.18" y="308.397">uses</text><!--MD5=[23afc520d71f001db74321da1ac11a6c]
link SendMessageUseCase to Message--><path d="M773.68,355.21 C811.43,387.37 849.18,432.62 849.18,485 C849.18,485 849.18,485 849.18,894.5 C849.18,941.8 831.77,991.05 812.43,1031.15 " fill="none" id="SendMessageUseCase-&gt;Message" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="810.07,1035.99,817.6244,1029.6709,812.2717,1031.5008,810.4417,1026.1482,810.07,1035.99" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="850.18" y="689.397">uses</text><!--MD5=[9c8a368da78a81cfd17e88a7967b147c]
link MessageRepository to Message--><path d="M621.88,538.11 C632.57,561.88 645.04,590.67 655.18,617 C691.03,710.13 704.25,732.65 726.18,830 C741.17,896.55 750.11,973.32 755.19,1030.71 " fill="none" id="MessageRepository-&gt;Message" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="755.64,1035.85,758.8545,1026.5405,755.2118,1030.8684,750.8839,1027.2256,755.64,1035.85" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="719.18" y="795.897">uses</text><!--MD5=[fa2713faeae989d5af89f1e34e0a6424]
link MessageRepositoryImpl to Message--><path d="M131.03,745.34 C91.58,765.83 55.8,793.27 31.18,830 C-0.25,876.89 -4.21,913.02 31.18,957 C113.7,1059.56 524.07,1100.06 690.69,1112.45 " fill="none" id="MessageRepositoryImpl-&gt;Message" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="696.03,1112.84,687.352,1108.1824,691.0438,1112.4685,686.7577,1116.1603,696.03,1112.84" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="32.18" y="898.897">uses</text><!--MD5=[5467645dddd3b0a1944ece0977d9c449]
link FirestoreHelper to Message--><path d="M439.16,957.07 C520.8,997.61 624.07,1048.9 691.33,1082.31 " fill="none" id="FirestoreHelper-&gt;Message" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="696.11,1084.68,689.8296,1077.0934,691.6322,1082.4553,686.2702,1084.2579,696.11,1084.68" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="538.18" y="1001.897">uses</text><!--MD5=[b30dafab54f3b986d57c9c3c148d9f2d]
link AuthRepository to User--><path d="M1339.71,347.82 C1362.76,382.02 1394.08,428.47 1413.7,457.59 " fill="none" id="AuthRepository-&gt;User" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1416.51,461.76,1414.7844,452.0635,1413.7102,457.6174,1408.1563,456.5432,1416.51,461.76" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="44" x="1375.18" y="399.897">returns</text><!--MD5=[f38db8e985e315e615e7000c855968f4]
@startuml
skinparam ClassAttributeFontColor #777
skinparam ClassAttributeFontColor<<Abstract>> #999
skinparam ClassAttributeFontColor<<Interface>> #555
skinparam ClassAttributeFontColor<<Model>> #444
skinparam ClassMethodFontColor #333
skinparam ClassMethodFontColor<<Abstract>> #555
skinparam ClassMethodFontColor<<Interface>> #222

class ChatScreen <<View / Composable>> {
    +viewModel: ChatViewModel
    - -
    +ChatScreen(viewModel: ChatViewModel)
}

class ChatViewModel <<ViewModel>> {
    -sendMessageUseCase: SendMessageUseCase
    -authRepository: AuthRepository
    +uiState: StateFlow<ChatUiState>
    +messages: StateFlow<List<Message>>
    - -
    +ChatViewModel(sendMessageUseCase: SendMessageUseCase, authRepository: AuthRepository)
    +loadMessages(groupId: String)
    +sendMessage(groupId: String, text: String)
}

class SendMessageUseCase <<Use Case / Domain>> {
    -messageRepository: MessageRepository
    - -
    +SendMessageUseCase(messageRepository: MessageRepository)
    +invoke(groupId: String, message: Message): Flow<Result<Unit>>
}

interface MessageRepository <<Interface / Domain>> {
    +sendMessage(groupId: String, message: Message): Flow<Result<Unit>>
    +getMessagesForGroup(groupId: String): Flow<List<Message>>
    +uploadMedia(...): Flow<Result<String>>
}

class MessageRepositoryImpl <<Data / Impl>> {
    -firestoreHelper: FirestoreHelper
    -firebaseStorage: FirebaseStorage
    - -
    +MessageRepositoryImpl(firestoreHelper: FirestoreHelper, firebaseStorage: FirebaseStorage)
    +sendMessage(groupId: String, message: Message): Flow<Result<Unit>>
    +getMessagesForGroup(groupId: String): Flow<List<Message>>
}

class Message <<Model>> {
    +id: String
    +groupId: String
    +senderId: String
    +senderName: String
    +text: String?
    +mediaUrl: String?
    +timestamp: Date?
}

class ChatUiState <<UI State>> {
    +isLoadingMessages: Boolean
    +sendMessageError: String?
    +currentUserName: String?
}

class Result <<Sealed Class>> {
    +Success<T>(data: T)
    +Error(exception: Throwable)
    +Loading
}

class FirestoreHelper <<Helper>> {
    -firestore: FirebaseFirestore
    - -
    +addDocument(collectionPath: String, data: Any, documentId: String?): suspend String
    +getCollection(collectionPath: String, T: Class): Flow<List<T>>
    - -
    // ...
}

interface AuthRepository <<Interface / Domain>> {
    +getCurrentUser(): Flow<Result<User?>>
    - -
    // ...
}

class FirebaseAuth <<External Service>> {
    - -
    // ...
}

class FirebaseStorage <<External Service>> {
    - -
    // ...
}

ChatScreen .up.|> ChatViewModel : observe() / calls()
ChatViewModel o- - SendMessageUseCase : composes (via DI)
ChatViewModel o- - AuthRepository : composes (via DI)

SendMessageUseCase o- - MessageRepository : composes (via DI)
MessageRepositoryImpl .up.|> MessageRepository : implements
MessageRepositoryImpl o- - FirestoreHelper : composes (via DI)
MessageRepositoryImpl o- - FirebaseStorage : composes (via DI)

ChatViewModel ..> Message : uses
ChatViewModel ..> ChatUiState : manages
ChatViewModel ..> User : uses

SendMessageUseCase ..> Message : uses
MessageRepository ..> Message : uses
MessageRepositoryImpl ..> Message : uses

FirestoreHelper ..> Message : uses
AuthRepository ..> User : returns
@enduml

PlantUML version 1.2020.02(Sun Mar 01 11:22:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 21.0.10+7-Debian-1deb13u1
Operating System: Linux
Default Encoding: UTF-8
Language: fr
Country: FR
--></g></svg>