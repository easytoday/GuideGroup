<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1386px" preserveAspectRatio="none" style="width:2022px;height:1386px;" version="1.1" viewBox="0 0 2022 1386" width="2022px" zoomAndPan="magnify"><defs><filter height="300%" id="f1gyef4s4ws0t" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="324" x="844.75" y="29.2419">Scénario de Connexion de l'Utilisateur</text><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="31.706" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="364.5" y="206.9958"/><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="31.706" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="364.5" y="1109.3522"/><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="31.706" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="364.5" y="1234.4522"/><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="1042.4564" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="547.5" y="238.7018"/><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="481.8842" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="846.5" y="420.2319"/><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="327.0602" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1216" y="497.6439"/><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="31.706" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1542" y="634.468"/><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="95.118" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1717.5" y="697.88"/><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="31.706" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1956.5" y="729.586"/><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="312.336" style="stroke: #000000; stroke-width: 2.0;" width="846" x="13" y="961.8221"/><rect fill="#FFFFFF" height="125.0999" style="stroke: none; stroke-width: 1.0;" width="846" x="13" y="1149.0582"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="41" x2="41" y1="127.5838" y2="1291.1582"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="369" x2="369" y1="127.5838" y2="1291.1582"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="552.5" x2="552.5" y1="127.5838" y2="1291.1582"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="851" x2="851" y1="127.5838" y2="1291.1582"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1034" x2="1034" y1="127.5838" y2="1291.1582"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1221" x2="1221" y1="127.5838" y2="1291.1582"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1546.5" x2="1546.5" y1="127.5838" y2="1291.1582"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1722.5" x2="1722.5" y1="127.5838" y2="1291.1582"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1961.5" x2="1961.5" y1="127.5838" y2="1291.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="23" y="123.4818">User</text><ellipse cx="41.5" cy="51.5158" fill="#FEFECE" filter="url(#f1gyef4s4ws0t)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M41.5,59.5158 L41.5,86.5158 M28.5,67.5158 L54.5,67.5158 M41.5,86.5158 L28.5,101.5158 M41.5,86.5158 L54.5,101.5158 " fill="none" filter="url(#f1gyef4s4ws0t)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="23" y="1305.1241">User</text><ellipse cx="41.5" cy="1319.2261" fill="#FEFECE" filter="url(#f1gyef4s4ws0t)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M41.5,1327.2261 L41.5,1354.2261 M28.5,1335.2261 L54.5,1335.2261 M41.5,1354.2261 L28.5,1369.2261 M41.5,1354.2261 L54.5,1369.2261 " fill="none" filter="url(#f1gyef4s4ws0t)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f1gyef4s4ws0t)" height="52.1358" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="315" y="70.4479"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="326" y="92.4139">LoginScreen</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="91" x="322" y="111.4818">(Composable)</text><rect fill="#FEFECE" filter="url(#f1gyef4s4ws0t)" height="52.1358" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="315" y="1290.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="326" y="1312.1241">LoginScreen</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="91" x="322" y="1331.192">(Composable)</text><rect fill="#FEFECE" filter="url(#f1gyef4s4ws0t)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="124" x="488.5" y="89.5158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="110" x="495.5" y="111.4818">LoginViewModel</text><rect fill="#FEFECE" filter="url(#f1gyef4s4ws0t)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="124" x="488.5" y="1290.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="110" x="495.5" y="1312.1241">LoginViewModel</text><rect fill="#FEFECE" filter="url(#f1gyef4s4ws0t)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="792" y="89.5158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="799" y="111.4818">SignInUseCase</text><rect fill="#FEFECE" filter="url(#f1gyef4s4ws0t)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="792" y="1290.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="799" y="1312.1241">SignInUseCase</text><rect fill="#FEFECE" filter="url(#f1gyef4s4ws0t)" height="52.1358" style="stroke: #A80036; stroke-width: 1.5;" width="117" x="974" y="70.4479"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="103" x="981" y="92.4139">AuthRepository</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="998" y="111.4818">(Interface)</text><rect fill="#FEFECE" filter="url(#f1gyef4s4ws0t)" height="52.1358" style="stroke: #A80036; stroke-width: 1.5;" width="117" x="974" y="1290.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="103" x="981" y="1312.1241">AuthRepository</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="998" y="1331.192">(Interface)</text><rect fill="#FEFECE" filter="url(#f1gyef4s4ws0t)" height="52.1358" style="stroke: #A80036; stroke-width: 1.5;" width="148" x="1145" y="70.4479"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="134" x="1152" y="92.4139">AuthRepositoryImpl</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="1199.5" y="111.4818">(Data)</text><rect fill="#FEFECE" filter="url(#f1gyef4s4ws0t)" height="52.1358" style="stroke: #A80036; stroke-width: 1.5;" width="148" x="1145" y="1290.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="134" x="1152" y="1312.1241">AuthRepositoryImpl</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="1199.5" y="1331.192">(Data)</text><rect fill="#FEFECE" filter="url(#f1gyef4s4ws0t)" height="52.1358" style="stroke: #A80036; stroke-width: 1.5;" width="125" x="1482.5" y="70.4479"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="1500.5" y="92.4139">FirebaseAuth</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="1489.5" y="111.4818">(Service Externe)</text><rect fill="#FEFECE" filter="url(#f1gyef4s4ws0t)" height="52.1358" style="stroke: #A80036; stroke-width: 1.5;" width="125" x="1482.5" y="1290.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="1500.5" y="1312.1241">FirebaseAuth</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="1489.5" y="1331.192">(Service Externe)</text><rect fill="#FEFECE" filter="url(#f1gyef4s4ws0t)" height="52.1358" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="1661.5" y="70.4479"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="1668.5" y="92.4139">FirestoreHelper</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="1694" y="111.4818">(Helper)</text><rect fill="#FEFECE" filter="url(#f1gyef4s4ws0t)" height="52.1358" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="1661.5" y="1290.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="1668.5" y="1312.1241">FirestoreHelper</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="1694" y="1331.192">(Helper)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="1930" y="104.4139">Firebase</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="1917.5" y="123.4818">Firestore DB</text><path d="M1943.5,53.4479 C1943.5,43.4479 1961.5,43.4479 1961.5,43.4479 C1961.5,43.4479 1979.5,43.4479 1979.5,53.4479 L1979.5,79.4479 C1979.5,89.4479 1961.5,89.4479 1961.5,89.4479 C1961.5,89.4479 1943.5,89.4479 1943.5,79.4479 L1943.5,53.4479 " fill="#FEFECE" filter="url(#f1gyef4s4ws0t)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1943.5,53.4479 C1943.5,63.4479 1961.5,63.4479 1961.5,63.4479 C1961.5,63.4479 1979.5,63.4479 1979.5,53.4479 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="1930" y="1305.1241">Firebase</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="1917.5" y="1324.192">Firestore DB</text><path d="M1943.5,1338.294 C1943.5,1328.294 1961.5,1328.294 1961.5,1328.294 C1961.5,1328.294 1979.5,1328.294 1979.5,1338.294 L1979.5,1364.294 C1979.5,1374.294 1961.5,1374.294 1961.5,1374.294 C1961.5,1374.294 1943.5,1374.294 1943.5,1364.294 L1943.5,1338.294 " fill="#FEFECE" filter="url(#f1gyef4s4ws0t)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1943.5,1338.294 C1943.5,1348.294 1961.5,1348.294 1961.5,1348.294 C1961.5,1348.294 1979.5,1348.294 1979.5,1338.294 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="31.706" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="364.5" y="206.9958"/><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="31.706" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="364.5" y="1109.3522"/><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="31.706" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="364.5" y="1234.4522"/><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="1042.4564" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="547.5" y="238.7018"/><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="481.8842" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="846.5" y="420.2319"/><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="327.0602" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1216" y="497.6439"/><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="31.706" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1542" y="634.468"/><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="95.118" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1717.5" y="697.88"/><rect fill="#FFFFFF" filter="url(#f1gyef4s4ws0t)" height="31.706" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1956.5" y="729.586"/><rect fill="#EEEEEE" filter="url(#f1gyef4s4ws0t)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="2007.5" x="3" y="159.4368"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="2010.5" y1="159.4368" y2="159.4368"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="2010.5" y1="162.4368" y2="162.4368"/><rect fill="#EEEEEE" filter="url(#f1gyef4s4ws0t)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="236" x="888.75" y="147.5838"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="219" x="894.75" y="165.4808">Phase 1: Saisie et Déclenchement</text><polygon fill="#A80036" points="352.5,202.9958,362.5,206.9958,352.5,210.9958,356.5,206.9958" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="41.5" x2="358.5" y1="206.9958" y2="206.9958"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="121" y="201.1868">1. Saisit email/mot de passe</text><polygon fill="#A80036" points="535.5,234.7018,545.5,238.7018,535.5,242.7018,539.5,238.7018" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="369.5" x2="541.5" y1="238.7018" y2="238.7018"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="381.5" y="232.8928">2. signIn(email, password)</text><rect fill="#EEEEEE" filter="url(#f1gyef4s4ws0t)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="2007.5" x="3" y="268.5548"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="2010.5" y1="268.5548" y2="268.5548"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="2010.5" y1="271.5548" y2="271.5548"/><rect fill="#EEEEEE" filter="url(#f1gyef4s4ws0t)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="315" x="849.25" y="256.7018"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="298" x="855.25" y="274.5988">Phase 2: Logique de Présentation (ViewModel)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="557.5" x2="599.5" y1="316.1138" y2="316.1138"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="599.5" x2="599.5" y1="316.1138" y2="329.1138"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="558.5" x2="599.5" y1="329.1138" y2="329.1138"/><polygon fill="#A80036" points="568.5,325.1138,558.5,329.1138,568.5,333.1138,564.5,329.1138" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="226" x="564.5" y="310.3048">3. Met à jour uiState (isLoading = true)</text><path d="M562,342.1138 L562,387.1138 L779,387.1138 L779,352.1138 L769,342.1138 L562,342.1138 " fill="#FBFB77" filter="url(#f1gyef4s4ws0t)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M769,342.1138 L769,352.1138 L779,352.1138 L769,342.1138 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="196" x="568" y="361.0109">La Vue observe cet état et affiche</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="568" y="378.7169">un indicateur de chargement.</text><polygon fill="#A80036" points="834.5,416.2319,844.5,420.2319,834.5,424.2319,838.5,420.2319" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="557.5" x2="840.5" y1="420.2319" y2="420.2319"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="623.5" y="414.4229">4. invoke(email, password)</text><rect fill="#EEEEEE" filter="url(#f1gyef4s4ws0t)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="2007.5" x="3" y="450.0849"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="2010.5" y1="450.0849" y2="450.0849"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="2010.5" y1="453.0849" y2="453.0849"/><rect fill="#EEEEEE" filter="url(#f1gyef4s4ws0t)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="240" x="886.75" y="438.2319"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="223" x="892.75" y="456.1289">Phase 3: Logique Métier (Use Case)</text><polygon fill="#A80036" points="1022.5,493.6439,1032.5,497.6439,1022.5,501.6439,1026.5,497.6439" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="856.5" x2="1028.5" y1="497.6439" y2="497.6439"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="868.5" y="491.8349">5. signIn(email, password)</text><path d="M1039,510.6439 L1039,555.6439 L1356,555.6439 L1356,520.6439 L1346,510.6439 L1039,510.6439 " fill="#FBFB77" filter="url(#f1gyef4s4ws0t)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1346,510.6439 L1346,520.6439 L1356,520.6439 L1346,510.6439 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="1045" y="529.5409">Appel à l'interface abstraite du Référentiel.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="296" x="1045" y="547.247">Le Use Case ne se soucie pas de l'implémentation.</text><rect fill="#EEEEEE" filter="url(#f1gyef4s4ws0t)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="2007.5" x="3" y="586.909"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="2010.5" y1="586.909" y2="586.909"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="2010.5" y1="589.909" y2="589.909"/><rect fill="#EEEEEE" filter="url(#f1gyef4s4ws0t)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="313" x="850.25" y="575.056"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="296" x="856.25" y="592.953">Phase 4: Accès aux Données (Repository Impl)</text><polygon fill="#A80036" points="1530,630.468,1540,634.468,1530,638.468,1534,634.468" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1226" x2="1536" y1="634.468" y2="634.468"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="296" x="1236" y="628.659">6. signInWithEmailAndPassword(email, password)</text><polygon fill="#A80036" points="1237,662.174,1227,666.174,1237,670.174,1233,666.174" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1231" x2="1546" y1="666.174" y2="666.174"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="292" x="1240.5" y="660.365">7. Résultat d'authentification (UID de l'utilisateur)</text><polygon fill="#A80036" points="1705.5,693.88,1715.5,697.88,1705.5,701.88,1709.5,697.88" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1226" x2="1711.5" y1="697.88" y2="697.88"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="285" x="1329.25" y="692.071">8. getDocument("users", userId, User::class.java)</text><polygon fill="#A80036" points="1944.5,725.586,1954.5,729.586,1944.5,733.586,1948.5,729.586" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1727.5" x2="1950.5" y1="729.586" y2="729.586"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="189" x="1747.5" y="723.777">9. Lit les données de l'utilisateur</text><polygon fill="#A80036" points="1738.5,757.2921,1728.5,761.2921,1738.5,765.2921,1734.5,761.2921" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1732.5" x2="1960.5" y1="761.2921" y2="761.2921"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="1742" y="755.4831">10. Données de l'utilisateur (User?)</text><polygon fill="#A80036" points="1237,788.9981,1227,792.9981,1237,796.9981,1233,792.9981" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1231" x2="1721.5" y1="792.9981" y2="792.9981"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="1447.25" y="787.1891">11. User?</text><polygon fill="#A80036" points="867.5,820.7041,857.5,824.7041,867.5,828.7041,863.5,824.7041" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="861.5" x2="1220" y1="824.7041" y2="824.7041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="922.25" y="818.8951">12. Flow&lt;Result&lt;User&gt;&gt; (Success/Error)</text><rect fill="#EEEEEE" filter="url(#f1gyef4s4ws0t)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="2007.5" x="3" y="854.5571"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="2010.5" y1="854.5571" y2="854.5571"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="2010.5" y1="857.5571" y2="857.5571"/><rect fill="#EEEEEE" filter="url(#f1gyef4s4ws0t)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="353" x="830.25" y="842.7041"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="336" x="836.25" y="860.6011">Phase 5: Retour à la Logique Métier et Présentation</text><polygon fill="#A80036" points="568.5,898.1161,558.5,902.1161,568.5,906.1161,564.5,902.1161" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="562.5" x2="850.5" y1="902.1161" y2="902.1161"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="588" y="896.3071">13. Flow&lt;Result&lt;User&gt;&gt; (Success/Error)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="557.5" x2="599.5" y1="933.8221" y2="933.8221"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="599.5" x2="599.5" y1="933.8221" y2="946.8221"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="558.5" x2="599.5" y1="946.8221" y2="946.8221"/><polygon fill="#A80036" points="568.5,942.8221,558.5,946.8221,568.5,950.8221,564.5,946.8221" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="564.5" y="928.0131">14. Collecte le résultat du Flow</text><path d="M13,961.8221 L76,961.8221 L76,970.8221 L66,980.8221 L13,980.8221 L13,961.8221 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="312.336" style="stroke: #000000; stroke-width: 2.0;" width="846" x="13" y="961.8221"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="28" y="976.7192">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="220" x="91" y="975.5811">[Si la connexion réussit (Result.Success)]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="557.5" x2="599.5" y1="1005.2342" y2="1005.2342"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="599.5" x2="599.5" y1="1005.2342" y2="1018.2342"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="558.5" x2="599.5" y1="1018.2342" y2="1018.2342"/><polygon fill="#A80036" points="568.5,1014.2342,558.5,1018.2342,568.5,1022.2342,564.5,1018.2342" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="275" x="564.5" y="999.4252">14.1 Met à jour uiState (isSignInSuccess = true)</text><path d="M562,1031.2342 L562,1076.2342 L845,1076.2342 L845,1041.2342 L835,1031.2342 L562,1031.2342 " fill="#FBFB77" filter="url(#f1gyef4s4ws0t)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M835,1031.2342 L835,1041.2342 L845,1041.2342 L835,1031.2342 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="568" y="1050.1312">Le ViewModel expose un état de succès.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="262" x="568" y="1067.8372">La Vue, l'observant, déclenche la navigation.</text><polygon fill="#A80036" points="385.5,1105.3522,375.5,1109.3522,385.5,1113.3522,381.5,1109.3522" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="379.5" x2="546.5" y1="1109.3522" y2="1109.3522"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="396" y="1103.5432">14.2 uiState mis à jour</text><polygon fill="#A80036" points="52.5,1137.0582,42.5,1141.0582,52.5,1145.0582,48.5,1141.0582" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="46.5" x2="368.5" y1="1141.0582" y2="1141.0582"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="299" x="56" y="1135.2492">14.3 Navigue vers l'écran principal (ex: MapScreen)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="859" y1="1150.0582" y2="1150.0582"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="209" x="18" y="1161.8172">[If la connexion échoue (Result.Error)]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="557.5" x2="599.5" y1="1189.7461" y2="1189.7461"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="599.5" x2="599.5" y1="1189.7461" y2="1202.7461"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="558.5" x2="599.5" y1="1202.7461" y2="1202.7461"/><polygon fill="#A80036" points="568.5,1198.7461,558.5,1202.7461,568.5,1206.7461,564.5,1202.7461" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="259" x="564.5" y="1183.9371">14.1 Met à jour uiState (errorMessage = "...")</text><polygon fill="#A80036" points="385.5,1230.4522,375.5,1234.4522,385.5,1238.4522,381.5,1234.4522" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="379.5" x2="546.5" y1="1234.4522" y2="1234.4522"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="396" y="1228.6432">14.2 uiState mis à jour</text><polygon fill="#A80036" points="52.5,1262.1582,42.5,1266.1582,52.5,1270.1582,48.5,1266.1582" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="46.5" x2="368.5" y1="1266.1582" y2="1266.1582"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="112" y="1260.3492">14.3 Affiche le message d'erreur</text><!--MD5=[7c56488d25b87dc4ee5283d33323940a]
@startuml
skinparam handwritten false
skinparam sequenceMessageAlign center
skinparam ParticipantPadding 20
skinparam BoxPadding 10

actor User as Utilisateur
participant "LoginScreen\n(Composable)" as LoginUI
participant "LoginViewModel" as LoginVM
participant "SignInUseCase" as SignInUC
participant "AuthRepository\n(Interface)" as AuthRepoI
participant "AuthRepositoryImpl\n(Data)" as AuthRepoImpl
participant "FirebaseAuth\n(Service Externe)" as FirebaseAuth
participant "FirestoreHelper\n(Helper)" as FirestoreH
database "Firebase\nFirestore DB" as FirestoreDB

title Scénario de Connexion de l'Utilisateur

== Phase 1: Saisie et Déclenchement ==
Utilisateur -> LoginUI : 1. Saisit email/mot de passe
activate LoginUI
LoginUI -> LoginVM : 2. signIn(email, password)
deactivate LoginUI
activate LoginVM

== Phase 2: Logique de Présentation (ViewModel) ==
LoginVM -> LoginVM : 3. Met à jour uiState (isLoading = true)
note right of LoginVM
  La Vue observe cet état et affiche
  un indicateur de chargement.
end note
LoginVM -> SignInUC : 4. invoke(email, password)
activate SignInUC

== Phase 3: Logique Métier (Use Case) ==
SignInUC -> AuthRepoI : 5. signIn(email, password)
note right of AuthRepoI
  Appel à l'interface abstraite du Référentiel.
  Le Use Case ne se soucie pas de l'implémentation.
end note
activate AuthRepoImpl

== Phase 4: Accès aux Données (Repository Impl) ==
AuthRepoImpl -> FirebaseAuth : 6. signInWithEmailAndPassword(email, password)
activate FirebaseAuth
FirebaseAuth - -> AuthRepoImpl : 7. Résultat d'authentification (UID de l'utilisateur)
deactivate FirebaseAuth
AuthRepoImpl -> FirestoreH : 8. getDocument("users", userId, User::class.java)
activate FirestoreH
FirestoreH -> FirestoreDB : 9. Lit les données de l'utilisateur
activate FirestoreDB
FirestoreDB - -> FirestoreH : 10. Données de l'utilisateur (User?)
deactivate FirestoreDB
FirestoreH - -> AuthRepoImpl : 11. User?
deactivate FirestoreH
AuthRepoImpl - -> SignInUC : 12. Flow<Result<User>> (Success/Error)
deactivate AuthRepoImpl

== Phase 5: Retour à la Logique Métier et Présentation ==
SignInUC - -> LoginVM : 13. Flow<Result<User>> (Success/Error)
deactivate SignInUC
LoginVM -> LoginVM : 14. Collecte le résultat du Flow
alt Si la connexion réussit (Result.Success)
    LoginVM -> LoginVM : 14.1 Met à jour uiState (isSignInSuccess = true)
    note right of LoginVM
      Le ViewModel expose un état de succès.
      La Vue, l'observant, déclenche la navigation.
    end note
    LoginVM - -> LoginUI : 14.2 uiState mis à jour
    activate LoginUI
    LoginUI -> Utilisateur : 14.3 Navigue vers l'écran principal (ex: MapScreen)
    deactivate LoginUI
else If la connexion échoue (Result.Error)
    LoginVM -> LoginVM : 14.1 Met à jour uiState (errorMessage = "...")
    LoginVM - -> LoginUI : 14.2 uiState mis à jour
    activate LoginUI
    LoginUI -> Utilisateur : 14.3 Affiche le message d'erreur
    deactivate LoginUI
end
deactivate LoginVM
@enduml

PlantUML version 1.2020.02(Sun Mar 01 11:22:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 21.0.10+7-Debian-1deb13u1
Operating System: Linux
Default Encoding: UTF-8
Language: fr
Country: FR
--></g></svg>